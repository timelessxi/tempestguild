<div class="container">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <div class="card bg-dark text-white">
                <div class="card-body">
                    <h2 class="text-center mb-4">Register</h2>
                    <form method="POST" action="/register" id="register-form">
                        <div class="form-group">
                            <label for="username">Username</label>
                            <input type="text" class="form-control" id="username" name="username" required>
                            <div class="invalid-feedback" id="username-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" class="form-control" id="email" name="email" required>
                            <div class="invalid-feedback" id="email-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="password">Password</label>
                            <input type="password" class="form-control" id="password" name="password" required>
                            <small class="form-text text-muted">Password must be at least 8 characters long and contain at least one uppercase letter, one number, and one special character.</small>
                            <div class="invalid-feedback" id="password-error"></div>
                        </div>
                        <div class="form-group">
                            <label for="character-name">Character Name</label>
                            <input type="text" class="form-control" id="character-name" name="character-name" required>
                        </div>
                        <button type="submit" class="btn btn-primary btn-block mt-4">Register</button>
                    </form>
                    <p class="text-center mt-3">
                        Already have an account? <a href="/login" class="text-primary">Login</a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for Client-Side Validation -->
<script>
    document.getElementById('register-form').addEventListener('submit', function(event) {
        // Prevent form submission until validation passes
        event.preventDefault();

        // Reset errors
        document.querySelectorAll('.invalid-feedback').forEach(function(el) {
            el.textContent = '';
        });
        
        let hasError = false;

        // Username validation (ensure it's not already taken)
        const username = document.getElementById('username').value;
        // Example AJAX check for existing username (pseudo-code, replace with actual server-side logic)
        // If username exists, show error
        if (username === 'existingUsername') { // Replace this condition with actual server-side logic
            document.getElementById('username-error').textContent = 'Username is already taken.';
            hasError = true;
        }

        // Email validation
        const email = document.getElementById('email').value;
        const emailPattern = /^[a-zA-Z0-9_.+-]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9-.]+$/;
        if (!emailPattern.test(email)) {
            document.getElementById('email-error').textContent = 'Please enter a valid email address.';
            hasError = true;
        }

        // Example AJAX check for existing email (pseudo-code)
        if (email === 'existingEmail@example.com') { // Replace this condition with actual server-side logic
            document.getElementById('email-error').textContent = 'Email is already registered.';
            hasError = true;
        }

        // Password validation (at least 8 characters, 1 uppercase, 1 number, 1 special character)
        const password = document.getElementById('password').value;
        const passwordPattern = /^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*]).{8,}$/;
        if (!passwordPattern.test(password)) {
            document.getElementById('password-error').textContent = 'Password must meet the criteria.';
            hasError = true;
        }

        // If there are no errors, submit the form
        if (!hasError) {
            this.submit();
        }
    });
</script>
